<section id="database">
    <h2 class="text-3xl font-bold text-white mb-6">Database Configuration</h2>

    <div class="space-y-6">
        <!-- Introduction -->
        <div>
            <div class="text-gray-400 text-sm mb-3">Overview</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <p class="text-gray-300 leading-relaxed">
                    Obsidian uses <strong class="text-white">ActiveJDBC</strong> as its ORM layer and <strong class="text-white">HikariCP</strong> for connection pooling.
                    The DB class provides a unified interface for managing database connections and transactions across SQLite, MySQL, and PostgreSQL.
                </p>
            </div>
        </div>

        <!-- Supported Databases -->
        <div>
            <div class="text-gray-400 text-sm mb-3">Supported Databases</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <div class="space-y-4">
                    <div>
                        <div class="text-red-400 font-semibold mb-2">SQLite</div>
                        <p class="text-gray-300 text-sm">File-based database, perfect for development and small applications</p>
                    </div>
                    <div>
                        <div class="text-red-400 font-semibold mb-2">MySQL</div>
                        <p class="text-gray-300 text-sm">Popular relational database with connection pooling support</p>
                    </div>
                    <div>
                        <div class="text-red-400 font-semibold mb-2">PostgreSQL</div>
                        <p class="text-gray-300 text-sm">Advanced relational database with robust features</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Environment Configuration -->
        <div>
            <div class="text-gray-400 text-sm mb-3">Environment Configuration</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <p class="text-gray-300 mb-4">
                    Obsidian uses <strong class="text-white">dotenv-java</strong> to manage database credentials securely.
                    Create a <code class="text-red-400">.env</code> file at your project root:
                </p>

                <div class="space-y-4">
                    <div>
                        <div class="text-white font-semibold mb-2">SQLite Configuration</div>
                        <pre class="line-numbers"><code class="language-bash"># Application
ENVIRONMENT=development
PORT_WEB=8080

# Database Configuration
DB_TYPE=sqlite
DB_PATH=database.db</code></pre>
                    </div>

                    <div>
                        <div class="text-white font-semibold mb-2">MySQL Configuration</div>
                        <pre class="line-numbers"><code class="language-bash"># Application
ENVIRONMENT=development
PORT_WEB=8080

# Database Configuration
DB_TYPE=mysql
DB_HOST=localhost
DB_PORT=3306
DB_NAME=my_database
DB_USER=root
DB_PASSWORD=secret</code></pre>
                    </div>

                    <div>
                        <div class="text-white font-semibold mb-2">PostgreSQL Configuration</div>
                        <pre class="line-numbers"><code class="language-bash"># Application
ENVIRONMENT=development
PORT_WEB=8080

# Database Configuration
DB_TYPE=postgresql
DB_HOST=localhost
DB_PORT=5432
DB_NAME=my_database
DB_USER=postgres
DB_PASSWORD=secret</code></pre>
                    </div>
                </div>

                <div class="bg-yellow-900/20 border border-yellow-700 p-4 rounded mt-4">
                    <div class="flex items-start gap-3">
                        <div class="text-yellow-400 text-xl">âš </div>
                        <div>
                            <div class="text-yellow-300 font-semibold">Security Warning</div>
                            <div class="text-yellow-200 text-sm">Never commit your <code>.env</code> file to version control. Add it to <code>.gitignore</code></div>
                        </div>
                    </div>
                </div>

                <div class="bg-zinc-900 border border-zinc-700 p-4 rounded mt-4">
                    <div class="text-gray-300 text-sm">
                        <strong class="text-white">Note:</strong> The framework automatically reads these variables at startup.
                        No code changes needed - just modify your <code class="text-red-400">.env</code> file and restart your application.
                    </div>
                </div>
            </div>
        </div>

        <!-- Connection Management -->
        <div>
            <div class="text-gray-400 text-sm mb-3">Connection Management</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <p class="text-gray-300 mb-4">
                    All database operations must be wrapped in <code class="text-red-400">DB.withConnection()</code> or <code class="text-red-400">DB.withTransaction()</code>.
                    This ensures proper connection lifecycle management.
                </p>

                <div class="space-y-4">
                    <div>
                        <div class="text-white font-semibold mb-2">Simple Query</div>
                        <pre class="line-numbers"><code class="language-java">// Fetch all articles
List&lt;Article&gt; articles = DB.withConnection(() ->
    Article.findAll().stream().toList()
);</code></pre>
                    </div>

                    <div>
                        <div class="text-white font-semibold mb-2">Single Operation</div>
                        <pre class="line-numbers"><code class="language-java">// Create and save a new article
Article article = DB.withConnection(() -> {
    Article newArticle = new Article();
    newArticle.set("title", "Getting Started");
    newArticle.set("content", "Welcome to Obsidian");
    newArticle.saveIt();
    return newArticle;
});</code></pre>
                    </div>

                    <div>
                        <div class="text-white font-semibold mb-2">Multiple Operations</div>
                        <pre class="line-numbers"><code class="language-java">// Multiple database operations
DB.withConnection(() -> {
    List&lt;Article&gt; articles = Article.where("published = ?", true);

    for (Article article : articles) {
        article.set("views", article.getInteger("views") + 1);
        article.saveIt();
    }

    return articles.size();
});</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Transactions -->
        <div>
            <div class="text-gray-400 text-sm mb-3">Transactions</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <p class="text-gray-300 mb-4">
                    Use <code class="text-red-400">DB.withTransaction()</code> when you need atomic operations.
                    Changes are automatically committed on success or rolled back on error.
                </p>

                <pre class="line-numbers"><code class="language-java">// Transfer operation with rollback on error
DB.withTransaction(() -> {
    User sender = User.findById(senderId);
    User receiver = User.findById(receiverId);

    if (sender.getBigDecimal("balance").compareTo(amount) < 0) {
        throw new IllegalStateException("Insufficient balance");
    }

    sender.set("balance", sender.getBigDecimal("balance").subtract(amount));
    receiver.set("balance", receiver.getBigDecimal("balance").add(amount));

    sender.saveIt();
    receiver.saveIt();

    return true;
});</code></pre>
            </div>
        </div>

        <!-- Connection Pool Configuration -->
        <div>
            <div class="text-gray-400 text-sm mb-3">Connection Pool (MySQL/PostgreSQL)</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <p class="text-gray-300 mb-4">
                    HikariCP is automatically configured for MySQL and PostgreSQL with optimized settings:
                </p>

                <div class="bg-zinc-900 border border-zinc-700 p-4 rounded">
                    <ul class="space-y-2 text-gray-300 text-sm">
                        <li><span class="text-red-400">Maximum Pool Size:</span> 20 connections</li>
                        <li><span class="text-red-400">Minimum Idle:</span> 5 connections</li>
                        <li><span class="text-red-400">Auto-commit:</span> Disabled (managed by ActiveJDBC)</li>
                    </ul>
                </div>

                <p class="text-gray-400 text-sm mt-4">
                    Note: SQLite uses direct JDBC connections without pooling.
                </p>
            </div>
        </div>

    </div>
</section>